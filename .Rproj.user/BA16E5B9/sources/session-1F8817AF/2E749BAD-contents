install.packages("devtools")
# Import the libraries
library(devtools)
install("C:/Users/65976/School/ST2195 Programming/Repository/Practice 10/analysis1")  #your path may be different
library(analysis1)
search()

# To unload and reload package
# detach(2, unload=TRUE) #to unload existing package in index position 2
# .libPaths() #location where R stores the libraries 

# Load data
# You could read the titanic dataset that was saved in the Python version of Practice Assignment 9
titanic <- read.csv("C:/Users/65976/School/ST2195 Programming/Repository/Practice 9/titanic_openml.csv")  #your file path may be different

# We can also try to load from OpenML (titanic's id is 40945)
#install.packages("mlr3oml")
#library(mlr3oml)
#list_oml_data(data_name = "titanic")  #search for titanic datasets
#odata <- OMLData$new(id=40945)  #get titanic dataset from OpenML using the data_id
#titanic <- as.data.frame(odata$data)
#str(titanic)
#head(titanic)
#summary(titanic)

# Convert to factors if required, and create the column "family_size"
titanic$survived <- factor(titanic$survived)
titanic$sex <- factor(titanic$sex)
titanic$embarked <- factor(titanic$embarked)
titanic$pclass <- factor(titanic$pclass, order = TRUE, levels = c(1, 2, 3))
titanic$family_size <- titanic$sibsp + titanic$parch + 1
titanic <- titanic[,c('age', 'fare', 'embarked', 'sex', 'pclass', 'family_size', 'survived')]

# Create plots
eda_plots(titanic, "survived")

# Fit the models
fitted_result <- fit_models(titanic, 0.5, "survived",
                            c('logistic regression', 'tree', 'gradient boosting', 'svm',
                              'penalised logistic regression','random forest'),
                            log_level = "error")

## Plot to compare the models
plot_model_comparison(fitted_result$task, fitted_result$fitted_models, log_level="error")
